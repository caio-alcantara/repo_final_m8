---
title: App Network Traffic Capture
description: Details of our attempt to capture network traffic information from the Unitree Go application
---

Esta seção detalha a tentativa empírica de interceptação e compreensão dos dados trafegados entre a aplicação Android e o robô em um ambiente controlado.

### 6. Objetivo

O objetivo destes testes é realizar uma auditoria "Caixa Preta" para compreender os payloads enviados pela aplicação Android para o robô. O foco é identificar comandos de movimentação e coleta de dados, facilitando a engenharia reversa dos mecanismos de controle do maquinário.

### 6.1 Metodologia

Os testes foram conduzidos sob os seguintes princípios rigorosos:

  * **Monitoramento Local:** Análise focada no escopo de rede do dispositivo controlador (Android).
  * **Estímulo Exaustivo:** Execução de todos os comandos disponíveis na GUI do aplicativo para mapear o comportamento completo da comunicação.
  * **Isolamento de Rede:** Testes realizados em ambiente de rede segregado para evitar contaminação de tráfego.
  * **Persistência de Dados:** Coleta e armazenamento de arquivos PCAP para análise *post-mortem*.



### 6.2 Diário de Análise

#### Dia 1: Análise de Logs de Sistema e Depuração (ADB)

A abordagem inicial focou na análise passiva interna do dispositivo controlador via Android Debug Bridge (ADB).

  * **Procedimento:** Utilização de depuração USB filtrando os logs do pacote `com.unitree.doggo2`.
  * **Observações:** Foi possível verificar o handshake de provisionamento Wi-Fi via Bluetooth, incluindo a descoberta de rede (Service Discovery) e a nomeação do dispositivo até a consolidação da conexão.
  * **Conclusão Crítica:** Não foi observado nenhum log explícito referente à **movimentação do robô** ou telemetria cinética. Isso indica que a comunicação de controle ocorre em camadas inferiores (socket level) que não registram saída no Logcat padrão do Android, exigindo uma estratégia de interceptação de rede mais agressiva.

#### Dia 2: Interceptação de Tráfego e Mapeamento de Superfície de Ataque

A estratégia evoluiu para uma interceptação ativa (Man-in-the-Middle), utilizando as ferramentas `Wireshark`, `PCAPDroid` e `Nmap`.

**Obstáculos de Proteção:**
A aplicação demonstrou mecanismos de defesa ativa (ou instabilidade sistêmica), resultando em *Crashes* imediatos ao detectar a interceptação. Isso limitou a coleta, permitindo apenas a análise do processo de configuração do modo AP antes do encerramento forçado.

**Descobertas de Telemetria Externa:**
Apesar dos bloqueios, identificou-se que a Unitree monitora ativamente a atividade:

  * **Conexões Persistentes:** Detectadas conexões com `global-robot-api.unitree.com`.
  * **Exfiltração de Dados:** O payload inclui estado do robô, comandos executados e, potencialmente, dados de sensores (Câmera/LiDAR).
  * **Resposta da API:** O servidor retornou código de erro `13003` ("request invalid"), confirmando que a autenticação falhou devido à detecção do monitoramento de rede.

**Mapeamento de Portas (Nmap vs. Wireshark no Alvo 192.168.180.217):**
A análise revelou uma discrepância entre portas anunciadas e portas operacionais, indicando serviços ocultos.

| Porta | Serviço | Estado | Análise |
| --- | --- | --- | --- |
| **80** | HTTP | Open | Interface web latente; não responde a requisições padrão. |
| **8551** | Unknown | Open | Aceita conexões, protocolo proprietário desconhecido. |
| **9991** | ISSA | Open | Serviço industrial, exposto sem autenticação aparente. |
| **10001** | SCP-Config | Open | Potencialmente acessível para modificações de configuração. |
| **6752** | **Comando** | **Oculta** | **Vetor Crítico.** Identificada via Wireshark, invisível ao Nmap. |

**Arquitetura de Comunicação Identificada (Porta 6752):**
A interceptação parcial capturou o protocolo principal de comando, que opera sem criptografia na porta oculta 6752.

  * **Estrutura do Pacote:**
    `[Cabeçalho] [Comprimento] [Instrução] [Dados] [Checksum]`
  * **Assinaturas de Cabeçalho:**
      * Requisição: `0x52`
      * Resposta: `0x51`
  * **Amostra de Handshake Capturado:**
    ```bash
    App -> Robô: 0x52 0x05 0x01 00 00 00 00 00 00 00 00 00 00 00 00
    Robô -> App: 0x51 0x05 0x01 0x01 [checksum]
    ```

**Vulnerabilidades Identificadas neste ciclo:**

1.  **Proteção Frágil:** O *crash* da aplicação sugere má implementação de tratamento de exceções SSL, contornável via bypass de SSL Pinning.
2.  **Cleartext:** O protocolo crítico (6752) não possui criptografia, suscetível a sniffing.
3.  **Validação Inexistente:** Aparenta validar apenas checksum, permitindo Replay Attacks e Injeção de Comandos.
4.  **Segurança por Obscuridade:** A porta 6752 não responde a scans (Nmap), sugerindo ativação por sequência específica ("Port Knocking" ou estado de sessão).

#### Dia 3: Desenvolvimento de Exploração e Intrusion (UniPwn)

Com base na análise anterior e na descoberta do repositório *unipwn*, o foco mudou de análise passiva para ofensiva.

  * **Desenvolvimento de Tooling:** Foram criados scripts baseados na vulnerabilidade de injeção de comando identificada na configuração Wi-Fi (detalhada na Seção 4).
  * **Reverse Shell:** Implementou-se uma ferramenta de *reverse shell* para testar a intrusão pós-exploração.
  * **Resultado:** A ferramenta permitiu tentativas de execução remota de código, validando a tese de que as vulnerabilidades de protocolo (Dia 2) e de sistema (Dia 3) podem ser encadeadas para controle total do robô.